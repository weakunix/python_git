v1: 14/22; TLE; brute force O(NM + 3^M)
